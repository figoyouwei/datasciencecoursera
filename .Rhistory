library(xlsx)
require(xlsx)
install.packages("xlsx")
library(xlsx)
dat <- read.xlsx("/Users/youweizheng/百度云同步/老公股票每笔交易盈亏.xlsx",
sheetName = "Sheet1")
install.packages("rJava")
install.packages("rJava")
install.packages("xlsxjars")
q()
library(xlsx)
dat <- read.xlsx("/Users/youweizheng/百度云同步/老公股票每笔交易盈亏.xlsx",
sheetName = "Sheet1")
normalizePath()
normalizePath("revenue.R")
rm(list=ls())
cat("\014")
library(xlsx)
dat <- read.xlsx("/Users/youweizheng/githubrepo/datasciencecoursera/revenue.xlsx",
sheetName = "Sheet1")
library(xlsx)
dat <- read.xlsx("/Users/youweizheng/BaiduYunPan/Husband Single Trade.xlsx",
sheetName = "Sheet1")
dat
View(dat)
dat$1
library(xlsx)
dat <- read.xlsx("/Users/youweizheng/BaiduYunPan/Husband_Single_Trade.xlsx",
sheetName = "Sheet1")
View(dat)
dat$Profit
source('~/githubrepo/datasciencecoursera/revenue.R', echo=TRUE)
View(dat)
dat[1,"Profit"]
dat[,"Profit"]
source('~/githubrepo/datasciencecoursera/revenue.R', echo=TRUE)
sum(dat$Profit)
dat$Profit
sum(dat$Profit,na.rm=TRUE)
source('~/githubrepo/datasciencecoursera/stock.R', echo=TRUE)
source('~/githubrepo/datasciencecoursera/stock.R', echo=TRUE)
source('~/githubrepo/datasciencecoursera/stock.R', echo=TRUE)
source('~/githubrepo/datasciencecoursera/stock.R', echo=TRUE)
rm(list=ls())
cat("\014")
source('~/githubrepo/datasciencecoursera/stock.R', echo=TRUE)
q()
dat_st <- read.xlsx("/Users/youweizheng/百度云同步盘/HusbandStock/Husband_Single_Trade.xlsx",
sheetName = "Sheet1")
rm(list=ls())
cat("\014")
library(xlsx)
dat_st <- read.xlsx("/Users/youweizheng/百度云同步盘/HusbandStock/Husband_Single_Trade.xlsx",
sheetName = "Sheet1")
dat_st <- read.xlsx("/Users/youweizheng/Google Drive/HusbandStock/Husband_Single_Trade.xlsx",
sheetName = "Sheet1")
dat_st <- read.xlsx("/Users/youweizheng/Google\ Drive/HusbandStock/Husband_Single_Trade.xlsx",
sheetName = "Sheet1")
library(xlsx)
dat_st <- read.xlsx("/Users/youweizheng/Google Drive/HusbandStock/Husband_Single_Trade.xlsx",
sheetName = "Sheet1")
dat_st <- read.xlsx("/Users/youweizheng/Google Drive/HusbandStock/Husband_Trades.xlsx",
sheetName = "Sheet1")
dat_st <- read.xlsx("/Users/youweizheng/百度云同步盘/HusbandStock/Husband_Trades.xlsx",
sheetName = "Sheet1")
source('~/githubrepo/datasciencecoursera/stock.R', echo=TRUE)
q()
source('~/githubrepo/datasciencecoursera/stock.R', echo=TRUE)
View(dat_st)
x <- as.POSIXct(c("2011-02-01", "2011-02-01", "2011-02-01"))
x
mo <- strftime(x, "%m")
mo
rm(list=ls())
cat("\014")
library(lubridate)
install.package(lubridate)
install.packages(lubridate)
install.packages("lubridate")
rm(list=ls())
cat("\014")
library(lubridate)
df <- data.frame(
date = today() + days(1:300),
x = runif(300)
)
df
## clear workspace and console ...
rm(list=ls())
cat("\014")
df <- data.frame(
date = today() + days(1:300),
x = runif(300)
)
View(df)
?runif
plot(runif(300))
plot(runif(300))
## clear workspace and console ...
rm(list=ls())
cat("\014")
df <- data.frame(
date = today() + days(1:300),
x = runif(300)
)
today()
days(1:300)
df$my <- floor_date(df$date, "month")
View(df)
q()
install.packages("plyr")
source('~/githubrepo/datasciencecoursera/dateplay.R', echo=TRUE)
rm(list=ls())
cat("\014")
rm(list=ls())
cat("\014")
library(lubridate)
df <- data.frame(
date = today() + days(1:300),
x = runif(300)
)
df$my <- floor_date(df$date, "month")
df$my <- floor_date(df$date, "month")
library(plyr)
ddply(df, "my", summarise, x = mean(x))
ddply(df, "my", summarise, y = mean(x))
source('~/githubrepo/datasciencecoursera/dateplay.R', echo=TRUE)
View(df)
ddply(df, "onthly", summarise, y = mean(x))
source('~/githubrepo/datasciencecoursera/dateplay.R', echo=TRUE)
q()
floor_date()
source('~/githubrepo/datasciencecoursera/dateplay.R', echo=TRUE)
?floor_date
library(lubridate)
dat_st$byMonth <- floor_date(dat_tr$date, "month")
dat_tr <- read.xlsx("/Users/youweizheng/百度云同步盘/HusbandStock/Husband_Trades.xlsx",
sheetName = "Sheet1")
dat_br <- read.xlsx("/Users/youweizheng/百度云同步盘/HusbandStock/Husband_Broker.xlsx",
sheetName = "Sheet1")
## ----- clear workspace and console ...
rm(list=ls())
cat("\014")
library(xlsx)
dat_tr <- read.xlsx("/Users/youweizheng/百度云同步盘/HusbandStock/Husband_Trades.xlsx",
sheetName = "Sheet1")
dat_br <- read.xlsx("/Users/youweizheng/百度云同步盘/HusbandStock/Husband_Broker.xlsx",
sheetName = "Sheet1")
library(lubridate)
dat_st$byMonth <- floor_date(dat_tr$date, "month")
dat_tr$byMonth <- floor_date(dat_tr$date, "month")
View(dat_tr)
dat_tr$byMonth <- floor_date(dat_tr$Date, "month")
dat_tr$byMonth <- floor_date(dat_tr$Date, "month",na.rm=TRUE)
## ----- clear workspace and console ...
rm(list=ls())
cat("\014")
library(xlsx)
dat_tr <- read.xlsx("/Users/youweizheng/百度云同步盘/HusbandStock/Husband_Trades.xlsx",
sheetName = "Sheet1")
dat_br <- read.xlsx("/Users/youweizheng/百度云同步盘/HusbandStock/Husband_Broker.xlsx",
sheetName = "Sheet1")
View(dat_tr)
## ----- clear workspace and console ...
rm(list=ls())
cat("\014")
library(xlsx)
dat_tr <- read.xlsx("/Users/youweizheng/百度云同步盘/HusbandStock/Husband_Trades.xlsx",
sheetName = "Sheet1")
dat_br <- read.xlsx("/Users/youweizheng/百度云同步盘/HusbandStock/Husband_Broker.xlsx",
sheetName = "Sheet1")
sum(dat_tr$Profit,na.rm=TRUE)
library(lubridate)
dat_tr$byMonth <- floor_date(dat_tr$Date, "month")
View(dat_tr)
library(plyr)
ddply(dat_tr, "byMonth", summarise, monthly = sum(Profits))
ddply(dat_tr, "byMonth", summarise, monthly = sum(Profit))
sum(dat_br$Income,na.rm=TRUE)
q()
q()
rm(list=ls())
cat("\014")
library(xlsx)
dat_tr <- read.xlsx("Husband_Trades.xlsx", sheetName = "Sheet1")
dat_br <- read.xlsx("Husband_Broker.xlsx", sheetName = "Sheet1")
rm(list=ls())
cat("\014")
library(xlsx)
dat_tr <- read.xlsx("/Users/youweizheng/Google Drive/HusbandStock/Husband_Trades.xlsx",
sheetName = "Sheet1")
dat_br <- read.xlsx("/Users/youweizheng/Google Drive/HusbandStock/Husband_Broker.xlsx",
sheetName = "Sheet1")
sum(dat_tr$Profit,na.rm=TRUE)
View(dat_tr)
rm(list=ls())
cat("\014")
library(xlsx)
dat_tr <- read.xlsx("/Users/youweizheng/Google Drive/HusbandStock/Husband_Trades.xlsx",
sheetName = "Sheet1")
dat_br <- read.xlsx("/Users/youweizheng/Google Drive/HusbandStock/Husband_Broker.xlsx",
sheetName = "Sheet1")
View(dat_tr)
## ----- clear workspace and console ...
rm(list=ls())
cat("\014")
## ----- read in Excel table ...
library(xlsx)
dat_tr <- read.xlsx("/Users/youweizheng/Google Drive/HusbandStock/Husband_Trades.xlsx",
sheetName = "Sheet1")
dat_br <- read.xlsx("/Users/youweizheng/Google Drive/HusbandStock/Husband_Broker.xlsx",
sheetName = "Sheet1")
View(dat_tr)
sum(dat_tr$Profit,na.rm=TRUE)
library(lubridate)
dat_tr$byMonth <- floor_date(dat_tr$Date, "month")
library(plyr)
ddply(dat_tr, "byMonth", summarise, monthly = sum(Profit))
sum(dat_br$Income,na.rm=TRUE)
wd <- getwd()
sprintf("Current working dir: %s", wd)
source('~/Google Drive/HusbandStock/analysis.R', echo=TRUE)
tr_monthly <- ddply(dat_tr, "byMonth", summarise, monthly = sum(Profit))
tr_monthly
cat("\014")
sprintf("total trade profit: %.2f", total_tr_profit)
sprintf("total broker profit: %.2f", total_br_profit)
q()
newrow = c(1:4)
existingDF = rbind(existingDF,newrow)
existingDF <- as.data.frame(matrix(seq(20),nrow=5,ncol=4))
View(existingDF)
seq(20)
existingDF = rbind(existingDF,newrow)
View(existingDF)
r <- 3
existingDF <- rbind(existingDF[1:r,],newrow,existingDF[-(1:r),])
View(existingDF)
insertRow <- function(df, newrow, nr) {
df[seq(r+1,nrow(df)+1),] <- df[seq(r,nrow(df)),]
df[r,] <- newrow
df
}
existingDF <- as.data.frame(matrix(seq(20),nrow=5,ncol=4))
r <- 3
newrow <- seq(4)
insertRow(existingDF,newrow,r)
rm(list=ls())
cat("\014")
insertRow <- function(df, newrow, nr) {
# function to add a new row to specified number of row
df[seq(r+1,nrow(df)+1),] <- df[seq(r,nrow(df)),]
df[r,] <- newrow
df
}
library(xlsx)
dat_tr <- read.xlsx("/Users/youweizheng/Google Drive/HusbandStock/Husband_Trades.xlsx",
sheetName = "Sheet1")
View(dat_tr)
library(lubridate)
today()
newtrade <- c(today(),"亿纬锂能 (300014)",100,"新高后会有回调")
nrow(dat_tr)
insertRow(dat_tr,newtrade,nrow(dat_tr))
insertRow <- function(df, newrow, nr) {
# function to add a new row to specified number of row
df[seq(nr+1,nrow(df)+1),] <- df[seq(nr,nrow(df)),]
df[nr,] <- newrow
df
}
insertRow(dat_tr,newtrade,nrow(dat_tr))
newtrade <- c(today(),"300014",100,"")
insertRow(dat_tr,newtrade,nrow(dat_tr))
today()
as.Date("01 Jan 2000")
as.Date(today())
newtrade <- c(as.Date(today()),"300014",100,"")
insertRow(dat_tr,newtrade,nrow(dat_tr))
as(today(),"character")
newtrade <- c(as(today(),"character"),"300014",100,"")
insertRow(dat_tr,newtrade,nrow(dat_tr))
View(dat_tr)
newtrade <- c(as(today(),"character"),'300014',100,'')
insertRow(dat_tr,newtrade,nrow(dat_tr));
View(dat_tr)
View(dat_tr)
newtrade <- c(as(today(),"character"),'300014',100,'')
dat_tr <- insertRow(dat_tr,newtrade,nrow(dat_tr)+1);
View(dat_tr)
rm(list=ls())
cat("\014")
insertRow <- function(df, newrow, nr) {
# function to add a new row to specified number of row
df[seq(nr+1,nrow(df)+1),] <- df[seq(nr,nrow(df)),]
df[nr,] <- newrow
df
}
library(xlsx)
dat_tr <- read.xlsx("/Users/youweizheng/Google Drive/HusbandStock/Husband_Trades.xlsx",
sheetName = "Sheet1")
newtrade <- c(as(today(),"character"),'300014',100,'')
dat_tr <- insertRow(dat_tr,newtrade,nrow(dat_tr)+1)
newtrade <- c(as(today(),"character"),as.character(300014),100,'')
newtrade
newtrade <- c(as(today(),"character"),"亿纬锂能 (300014)","100","创新高后回落")
dat_tr <- insertRow(dat_tr,newtrade,nrow(dat_tr)+1)
View(dat_tr)
## ----- clear workspace and console ...
rm(list=ls())
cat("\014")
insertRow <- function(df, newrow, nr) {
# function to add a new row to specified number of row
df[seq(nr+1,nrow(df)+1),] <- df[seq(nr,nrow(df)),]
df[nr,] <- newrow
df
}
library(xlsx)
dat_tr <- read.xlsx("/Users/youweizheng/Google Drive/HusbandStock/Husband_Trades.xlsx",
sheetName = "Sheet1")
library(lubridate)
newtrade <- c(as(today(),"character"),"亿纬锂能 (300014)","100","ok")
dat_tr <- insertRow(dat_tr,newtrade,92)
View(dat_tr)
library(xlsx)
dat_tr <- read.xlsx("/Users/youweizheng/Google Drive/HusbandStock/Husband_Trades.xlsx",
sheetName = "Sheet1")
View(dat_tr)
newtrade
rbind(dat_tr,newtrade)
dat_tr <- rbind(dat_tr,newtrade)
View(dat_tr)
dat_tr <- rbind(dat_tr,newtrade)
View(dat_tr)
dat_tr[92]
dat_tr[92,]
dat_tr[92,"Comment"]
dat_tr[92,"Comment"] <- "da"
dat_tr[92,"Profit"] <- "da"
dat_tr[92,"Profit"]
?read.xlsx
dat_tr <- read.xlsx("/Users/youweizheng/Google Drive/HusbandStock/Husband_Trades.xlsx",
sheetName = "Sheet1",colIndex=c(1,2,3,4))
View(dat_tr)
dat_tr[91,"Comment"]
rm(list=ls())
cat("\014")
library(xlsx)
dat_tr <- read.xlsx("/Users/youweizheng/Google Drive/HusbandStock/Husband_Trades.xlsx",
sheetName = "Sheet1",colIndex=c(1,2,3))
dat_tr(91,"Comment")
dat_tr[91,"Comment"]
dat_tr[91,"Profit"]
dat_tr <- read.xlsx("/Users/youweizheng/Google Drive/HusbandStock/Husband_Trades.xlsx",
sheetName = "Sheet1",colIndex=c(1,2,3,4))
dat_tr[91,"Comment"]
class(dat_tr[91,"Comment"])
library(xlsx)
dat_tr <- read.xlsx("/Users/youweizheng/Google Drive/HusbandStock/Husband_Trades.xlsx",
sheetName = "Sheet1",colIndex=c(1,2,3,4))
dat_tr <- data.frame(lapply(dat_tr, as.character), stringsAsFactors=FALSE)
class(dat_tr[91,"Comment"])
class(dat_tr[90,"Comment"])
class(dat_tr[90,"Profit"])
help(options)
i <- sapply(dat_tr, is.factor)
i
dat_tr <- read.xlsx("/Users/youweizheng/Google Drive/HusbandStock/Husband_Trades.xlsx",
sheetName = "Sheet1",colIndex=c(1,2,3,4))
i <- sapply(dat_tr, is.factor)
i
dat_tr[i] <- lapply(bob[i], as.character)
dat_tr[i] <- lapply(dat_tr[i], as.character)
i <- sapply(dat_tr, is.factor)
i
dat_tr[91,"Comment"]
dat_tr <- rbind(dat_tr,newtrade)
library(lubridate)
newtrade <- c(as(today(),"character"),"亿纬锂能 (300014)","100","创新高后可能回落")
dat_tr <- rbind(dat_tr,newtrade)
View(dat_tr)
dat_tr <- dat_tr[-92,]
q()
?write.xlsx
library(xlsx)
?write.xlsx
source('~/Google Drive/HusbandStock/addNew.R', echo=TRUE)
View(dat_tr_new)
?write.xlsx
write.xlsx2(dat_tr_new, "/Users/youweizheng/Google Drive/HusbandStock/dat_tr_new.xlsx")
View(dat_tr_new)
write.xlsx2(dat_tr_new, "/Users/youweizheng/Google Drive/HusbandStock/dat_tr_new.xlsx",
row.names=FALSE)
rm(list=ls())
cat("\014")
library(xlsx)
dat_tr <- read.xlsx("/Users/youweizheng/Google Drive/HusbandStock/Husband_Trades.xlsx",
sheetName = "Sheet1",colIndex=c(1,2,3,4))
i <- sapply(dat_tr, is.factor)
dat_tr[i] <- lapply(dat_tr[i], as.character)
View(dat_tr)
q()
library(lubridate)
today()+day(1)
today()+days(1)
source('~/Google Drive/HusbandStock/addNew.R', echo=TRUE)
source('~/Google Drive/HusbandStock/addNew.R', echo=TRUE)
rm(list=ls())
cat("\014")
library(xlsx)
dat_tr <- read.xlsx("/Users/youweizheng/Google Drive/HusbandStock/Husband_Trades.xlsx",
sheetName = "Sheet1",colIndex=c(1,2,3,4))
total_tr_profit <- sum(dat_tr$Profit,na.rm=TRUE)
dat_tr$byMonth <- floor_date(dat_tr$Date, "month")
monthly_tr <- ddply(dat_tr, "byMonth", summarise, monthly = sum(Profit))
library(lubridate)
library(plyr)
monthly_tr <- ddply(dat_tr, "byMonth", summarise, monthly = sum(Profit))
library(xlsx)
dat_tr <- read.xlsx("/Users/youweizheng/Google Drive/HusbandStock/Husband_Trades.xlsx",
sheetName = "Sheet1",colIndex=c(1,2,3,4))
i <- sapply(dat_tr, is.factor)
dat_tr[i] <- lapply(dat_tr[i], as.character)
total_tr_profit <- sum(dat_tr$Profit,na.rm=TRUE)
total_tr_profit <- sum(as.numeric(dat_tr$Profit),na.rm=TRUE)
library(lubridate)
library(plyr)
dat_tr$byMonth <- floor_date(dat_tr$Date, "month")
monthly_tr <- ddply(dat_tr, "byMonth", summarise, monthly = sum(Profit))
dat_tr$Profit <- as.numeric(dat_tr$Profit)
library(lubridate)
library(plyr)
dat_tr$byMonth <- floor_date(dat_tr$Date, "month")
monthly_tr <- ddply(dat_tr, "byMonth", summarise, monthly = sum(Profit))
View(monthly_tr)
cat("\014")
sprintf("total trade profit: %.2f", total_tr_profit)
monthly_tr
q()
q()
source('~/Google Drive/HusbandStock/analysis.R', echo=TRUE)
View(monthly_tr)
View(dat_tr)
source('~/Google Drive/HusbandStock/analysis.R', echo=TRUE)
View(dat_tr)
source('~/Google Drive/HusbandStock/analysis.R', echo=TRUE)
View(dat_tr)
source('~/githubrepo/datasciencecoursera/GettingAndCleaningData/DownloadingFiles.R', echo=TRUE)
q()
