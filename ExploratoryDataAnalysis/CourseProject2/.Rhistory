NEI <- readRDS("summarySCC_PM25.rds")
SCC <- readRDS("Source_Classification_Code.rds")
head(NEI)
NEI[1:6,]
NEI[1:10,]
names(NEI)
q()
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
q()
source('~/Google Drive/HusbandStock/addNewTrade.R', echo=TRUE)
q()
q()
q()
source(load_data.R)
getwd()
source("load_data.R")
head(NEI)
head(SCC)
names(NEI)
class(NEI$year)
NEI$year <- as.factor(NEI$year)
class(NEI$year)
levels(NEI$year)
total_emissions_over_years <- tapply(NEI$Emissions, NEI$year, sum)
total_emissions_over_years
NEI$Pollutant <- as.factor(NEI$Pollutant)
levels(NEI$Pollutant)
barplot(total_emissions_over_years, main="Emission Over the Years ", xlab="Years")
png(file="./plot1.png",width=480, height=480)
barplot(total_emissions_over_years, main="Emission Over the Years ", xlab="Years")
dev.off()
barplot(total_emissions_over_years, main="Emission Over the Years ", xlab="Years", las=1)
source('~/Google Drive/githubrepo/datasciencecoursera/ExploratoryDataAnalysis/CourseProject2/plot1.R', echo=TRUE)
png(file="./plot1.png",width=480, height=480)
# las: 0=parallel, 1=all horizontal, 2=all perpendicular to axis, 3=all vertical
barplot(total_emissions_over_years, main="Total Emissions from PM2.5", xlab="Years", las=1)
dev.off()
barplot(total_emissions_over_years, main="Total Emissions from PM2.5", xlab="Years", las=1)
fit <- lm(total_emissions_over_years ~ levels(NEI$year))
barplot(total_emissions_over_years, main="Total Emissions from PM2.5", xlab="Years", las=1)
fit <- lm(total_emissions_over_years ~ levels(NEI$year))
abline(fit, lwd=3, col="red")
barplot(total_emissions_over_years, main="Total Emissions from PM2.5", xlab="Years", las=1)
fit <- lm(total_emissions_over_years ~ c(1999,2002,2005,2008))
abline(fit, lwd=3, col="red")
plot1bar <- barplot(total_emissions_over_years, main="Total Emissions from PM2.5",
xlab="Years", las=1)
plot1bar
plot1bar <- barplot(total_emissions_over_years, main="Total Emissions from PM2.5",
xlab="Years", las=1)
lines(x=plot1bar, y=total_emissions_over_years)
lines(x=plot1bar, y=total_emissions_over_years, col="red")
lines(x=plot1bar, y=total_emissions_over_years, lw=3, col="red")
plot1bar <- barplot(total_emissions_over_years, main="Total Emissions from PM2.5",
xlab="Years", las=1)
lines(x=plot1bar, y=total_emissions_over_years*0.9, lw=3, col="red")
plot1bar <- barplot(total_emissions_over_years, main="Total Emissions from PM2.5",
xlab="Years", las=1)
lines(x=plot1bar, y=total_emissions_over_years*0.9, lw=3, col="red")
points(x=plot1bar, y=total_emissions_over_years*0.9, lw=3, col="red")
png(file="./plot1.png",width=480, height=480)
# las: 0=parallel, 1=all horizontal, 2=all perpendicular to axis, 3=all vertical
plot1bar <- barplot(total_emissions_over_years, main="Total Emissions from PM2.5",
xlab="Years", las=1)
lines(x=plot1bar, y=total_emissions_over_years*0.9, lw=3, col="red")
points(x=plot1bar, y=total_emissions_over_years*0.9, lw=3, col="red")
dev.off()
q()
powfun <- function(x, pow) { x^pow }
rm(list=ls())
cat("\014")
powfun <- function(x, pow) { x^pow }
powfun(2,4)
rm(list=ls())
cat("\014")
powfun <- function(x, pow) { x^pow }
powfun(2, 10)
rm(list=ls())
cat("\014")
(function(x, pow) {
x^pow
})(2, 10)
`+`(1, 2)
`+`(1, 2)
`+`(4, 5)
1:10
`:`(1, 10)
`:`(1, 20)
x <- c()
for (i in 1:200000) {
if (i %% 2 == 0) {
x <- c(x, i)
}
}
4 %% 2
?%%
%%
helP('%%')
help('%%')
4 %/% 2
4 % 2
4 %% 2
c(4,6,7,8) %% 2 == 0
c(4) %% 2 == 0
df <- data.frame(x=c(1,2,3), x=c(4,5,6))
## clear workspace and console ...
rm(list=ls())
cat("\014")
## apply family
df <- data.frame(x=c(1,2,3), x=c(4,5,6))
View(df)
df <- data.frame(x=c(1,2,3), y=c(4,5,6))
View(df)
?sapply
sapply(df, sum)
result <- sapply(df, sum)
?Reduce
Reduce(sum,df)
lapply(df, sum)
apply(df, sum)
apply(df, 1, sum)
apply(df, 2, sum)
?apply
## clear workspace and console ...
rm(list=ls())
cat("\014")
## apply family
df <- data.frame(x=c(1,2,3), y=c(4,5,6))
lapply(df, sum)
sapply(df, sum)
apply(df, 2, sum)
## clear workspace and console ...
rm(list=ls())
cat("\014")
## apply family
df <- data.frame(x=c(1,2,3), y=c(4,5,6))
rl <- lapply(df, sum) # return a list
rs <- sapply(df, sum) # return a vector
r <- apply(df, 2, sum)
View(r)
View(rs)
class(rs)
rs[1]
rs[2]
names(rs)
View(rs)
heads(rs)
head(rs)
rm(list=ls())
cat("\014")
## demonstration of closure and function within function
boot.lm <- function(formula, data, ...) {
function() {
lm(formula=formula,
data=data[sample(nrow(data), replace=TRUE),], ...)
}
}
iris
iris.boot <- boot.lm(Sepal.Length ~ Petal.Length, iris)
bstrap <- sapply(X=1:1000,
FUN=function(x) iris.boot()$coef)
iris.boot()$coef
Sepal.Length ~ Petal.Length
q()
## clear workspace & console, and import ggplot2
rm(list=ls())
cat("\014")
source("load_data.R")
head(NEI)
NEI$year <- as.factor(NEI$year)
NEI$Pollutant <- as.factor(NEI$Pollutant)
NEI$type <- as.factor(NEI$type)
levels(NEI$type)
NEI_Maryland <- NEI[(NEI$fips == "24510"),]
NEI_1999 <- NEI[(NEI$fips == "24510" && NEI$year == "1999"),]
NEI_1999 <- NEI[(NEI$fips == "24510" && NEI$year == 1999),]
NEI$year
NEI$year == '1999'
NEI_Maryland <- NEI[NEI$fips == "24510",]
remove(NEI_1999)
View(NEI_Maryland)
levels(NEI_Maryland$year)
NEI_Maryland$year <- as.character(NEI_Maryland$year)
?tapply
NEI$year <- as.factor(NEI$year)
NEI$Pollutant <- as.factor(NEI$Pollutant)
NEI$type <- as.factor(NEI$type)
NEI_Maryland <- NEI[NEI$fips == "24510",]
results <- tapply(NEI_Maryland, conds, sum)
conds <- list(NEI$year, NEI$type)
results <- tapply(NEI_Maryland, conds, sum)
results <- tapply(NEI_Maryland$Emissions, conds, sum)
NEI_Maryland <- NEI[NEI$fips == "24510",]
conds <- list(NEI_Maryland$year, NEI_Maryland$type)
results <- tapply(NEI_Maryland$Emissions, conds, sum)
results
class(results)
as.data.frame(results)
results <- as.data.frame(tapply(NEI_Maryland$Emissions, conds, sum))
View(results)
?as.data.frame
results <- as.data.frame(tapply(NEI_Maryland$Emissions, conds, sum))
results.row.names
results$YEAR <- c("1999", "2002", "2005", "2008")
results$YEAR <- as.factor(c("1999", "2002", "2005", "2008"))
View(results)
?View
class(results$YEAR)
head(results)
g <- ggplot(results, aes(x=YEAR, y=NON-ROAD))
g + geom_line()
library(ggplot2)
g <- ggplot(results, aes(x=YEAR, y=NON-ROAD))
g + geom_line()
names(results)
g <- ggplot(results, aes(x="YEAR", y="NON-ROAD"))
g + geom_line()
names(results) <- c("NON_ROAD", "NON_POINT", "ON_ROAD", "POINT", "YEAR")
library(ggplot2)
g <- ggplot(results, aes(x=YEAR, y=NON_ROAD))
g + geom_line()
g <- ggplot(results, aes(YEAR, NON_ROAD))
g + geom_line()
g <- ggplot(mpg, aes(displ,hwy))
g + geom_point()
head(mpg)
class(mpg$year)
class(mpg$displ)
g <- ggplot(results, aes(YEAR, NON_ROAD))
g + geom_point()
g <- ggplot(results, aes(YEAR, NON_ROAD))
g + geom_line()
NEI_Maryland <- NEI[NEI$fips == "24510",]
conds <- list(NEI_Maryland$year, NEI_Maryland$type)
results <- as.data.frame(tapply(NEI_Maryland$Emissions, conds, sum))
results$YEAR <- as.numeric(c(1999, 2002, 2005, 2008))
names(results) <- c("NON_ROAD", "NON_POINT", "ON_ROAD", "POINT", "YEAR")
g <- ggplot(results, aes(YEAR, NON_ROAD))
g + geom_line()
g <- ggplot(results, aes(YEAR, NON_ROAD))
g + geom_line() + ggtitle("NON_ROAD")
g1 <- ggplot(results, aes(YEAR, NON_ROAD)) + geom_line() + ggtitle("NON_ROAD")
g1 <- ggplot(results, aes(YEAR, NON_ROAD)) + geom_line() + ggtitle("NON_ROAD")
g2 <- ggplot(results, aes(YEAR, NON_POINT)) + geom_line() + ggtitle("NON_POINT")
g3 <- ggplot(results, aes(YEAR, ON_ROAD)) + geom_line() + ggtitle("ON_ROAD")
g4 <- ggplot(results, aes(YEAR, POINT)) + geom_line() + ggtitle("POINT")
multiplot(g1, g2, g3, g4, cols=2)
source("multiplot.R")
multiplot(g1, g2, g3, g4, cols=2)
g <- multiplot(g1, g2, g3, g4, cols=2)
NEI_Maryland <- NEI[NEI$fips == "24510",]
conds <- list(NEI_Maryland$year, NEI_Maryland$type)
results <- as.data.frame(tapply(NEI_Maryland$Emissions, conds, sum))
results$YEAR <- as.numeric(c(1999, 2002, 2005, 2008))
names(results) <- c("nonroad", "nonpoint", "onroad", "point", "year")
multiplot(g1,g2,g3,g4,cols=2)
g1 <- ggplot(results, aes(year, nonroad)) + geom_line() + ggtitle("nonroad")
g2 <- ggplot(results, aes(year, nonpoint)) + geom_line() + ggtitle("nonpoint")
g3 <- ggplot(results, aes(year, onroad)) + geom_line() + ggtitle("onroad")
g4 <- ggplot(results, aes(year, point)) + geom_line() + ggtitle("point")
multiplot(g1,g2,g3,g4,cols=2)
source('~/Google Drive/githubrepo/datasciencecoursera/ExploratoryDataAnalysis/CourseProject2/plot4.R', echo=TRUE)
head(SCC)
class(NEI$SCC.Level.One)
class(SCC$SCC.Level.One)
levels(SCC$SCC.Level.One)
View(SCC)
levels(SCC$EI.Sector)
class(SCC$Short.Name)
levels(SCC$Short.Name)
"Coal" %in% "Ext Comb /Electric Gen /Anthracite Coal /Pulverized Coal"
"Ext Comb /Electric Gen /Anthracite Coal /Pulverized Coal" %in% c("Coal")
"Coal" %in% "Ext Comb /Electric Gen /Anthracite Coal /Pulverized Coal"
d<-data.frame(name=c("brown cat", "blue cat", "big lion", "tall tiger",
"black panther", "short cat", "red bird",
"short bird stuffed", "big eagle", "bad sparrow",
"dog fish", "head dog", "brown yorkie",
"lab short bulldog"), label=1:14)
View(d)
d[grep("cat|lion|tiger|panther", d$name), "species"] <- "feline"
grep("cat|lion|tiger|panther", d$name)
grep("coal|comb", SCC$Short.Name)
grep("Coal|comb", SCC$Short.Name)
grep("coal|comb", SCC$Short.Name, ignore.case = TRUE)
?grep
grep("coal&&comb", SCC$Short.Name, ignore.case = TRUE)
grep("coal&comb", SCC$Short.Name, ignore.case = TRUE)
grep(c("coal", "comb"), SCC$Short.Name, ignore.case = TRUE)
grepl("(?=.coal)(?=.comb)", SCC$Short.Name, ignore.case = TRUE)
grepl("(?=.*coal)(?=.*comb)", SCC$Short.Name, ignore.case = TRUE)
xmatches <- intersect(
grep("coal", SCC$Short.Name, ignore.case=TRUE),
grep("comb", SCC$Short.Name, ignore.case=TRUE))
xmatches
remove(xmatches)
xmatches_name <- intersect(
grep("coal", SCC$Short.Name, ignore.case=TRUE),
grep("comb", SCC$Short.Name, ignore.case=TRUE))
xmatches_scc <- SCC[xmatches_name,"SCC"]
levels(SCC$SCC.Level.Two)
xmatches_name <- intersect(
grep("coal", SCC$EI.Sector, ignore.case=TRUE),
grep("comb", SCC$EI.Sector, ignore.case=TRUE))
xmatches_scc <- SCC[xmatches_name,"SCC"]
levels(xmatches_scc$SCC)
levels(xmatches_scc$SCC)
levels(xmatches_scc)
length(xmatches_scc)
View(xmatches_scc)
xmatches_name
class(xmatches_scc)
levels(xmatches_scc)
xmatches_scc[1]
xmatches_scc[2]
dat_match <- SCC[xmatches_name,]
scc_match <- SCC[xmatches_name,"SCC"]
remove(xmatches_scc)
remove(multiplot)
scc_match[1:99]
scc_match[1:100]
scc_match[1:99]
Code<-c("A","B","C","D","C","D","A","A")
Value<-c(1, 2, 3, 4, 1, 2, 3, 4)
data<-data.frame(cbind(Code, Value))
selected<-c("A","B")
data[data$Code %in% selected,]
Code<-as.factor(c("A","B","C","D","C","D","A","A"))
Value<-c(1, 2, 3, 4, 1, 2, 3, 4)
data<-data.frame(cbind(Code, Value))
selected<-as.factor(c("A","B"))
data[data$Code %in% selected,]
as.character(scc_match)
names(NEI)
dat_match <- NEI[as.character(NEI$SCC) %in% as.character(scc_match),]
total_emissions_over_years <- tapply(dat_match$Emissions, dat_match$year, sum)
png(file="./plot4.png",width=480, height=480)
plot4bar <- barplot(total_emissions_over_years,
main="Total Emissions from PM2.5 with coal-combustion related sources",
xlab="Years", las=1)
lines(x=plot4bar, y=total_emissions_over_years*0.9, lw=3, col="red")
points(x=plot4bar, y=total_emissions_over_years*0.9, lw=3, col="red")
dev.off()
png(file="./plot4.png",width=480, height=480)
plot4bar <- barplot(total_emissions_over_years,
main="Emissions with coal-combustion related sources",
xlab="Years", las=1)
lines(x=plot4bar, y=total_emissions_over_years*0.9, lw=3, col="red")
points(x=plot4bar, y=total_emissions_over_years*0.9, lw=3, col="red")
dev.off()
## clear workspace & console, and import ggplot2
rm(list=ls())
cat("\014")
source("load_data.R")
View(SCC)
class(SCC$Short.Name)
levels(SCC$Short.Name)
levels(SCC$Short.Name)[5000:9000]
levels(SCC$Short.Name)[3000:6000]
levels(SCC$Short.Name)[4000:6000]
levels(SCC$Short.Name)[5000:6000]
levels(SCC$Short.Name)[6000:7000]
xmatches_name <- intersect(
grep("Motor", SCC$Short.Name, ignore.case=TRUE),
grep("Vehicle", SCC$Short.Name, ignore.case=TRUE))
scc_match <- SCC[xmatches_name,"SCC"]
dat_match <- NEI[as.character(NEI$SCC) %in% as.character(scc_match),]
total_emissions_over_years <- tapply(dat_match$Emissions, dat_match$year, sum)
png(file="./plot5.png",width=480, height=480)
plot5bar <- barplot(total_emissions_over_years,
main="Emissions with motor vehicle sources",
xlab="Years", las=1)
lines(x=plot5bar, y=total_emissions_over_years*0.9, lw=3, col="red")
points(x=plot5bar, y=total_emissions_over_years*0.9, lw=3, col="red")
dev.off()
dat_match_US <- NEI[as.character(NEI$SCC) %in% as.character(scc_match),]
dat_match_Maryland <- dat_match_US[NEI$fips == "24510",]
dat_match_Maryland <- dat_match_US[dat_match_US$fips == "24510",]
total_emissions_over_years <- tapply(dat_match$Emissions, dat_match$year, sum)
total_emissions_over_years <- tapply(dat_match_Maryland$Emissions, dat_match_Maryland$year, sum)
png(file="./plot5.png",width=480, height=480)
plot5bar <- barplot(total_emissions_over_years,
main="Emissions with motor vehicle sources",
xlab="Years", las=1)
lines(x=plot5bar, y=total_emissions_over_years*0.9, lw=3, col="red")
points(x=plot5bar, y=total_emissions_over_years*0.9, lw=3, col="red")
dev.off()
View(total_emissions_over_years)
dat_match_LosAngelos <- dat_match_US[dat_match_US$fips == "06037",]
total_emissions_Maryland <- tapply(dat_match_LosAngelos$Emissions, dat_match_LosAngelos$year, sum)
total_emissions_LA <- tapply(dat_match_LosAngelos$Emissions, dat_match_LosAngelos$year, sum)
png(file="./plot6.png",width=480, height=480)
plot6bar <- barplot(total_emissions_LA,
main="Emissions with motor vehicle sources",
xlab="Years", las=1)
lines(x=plot6bar, y=total_emissions_over_years*0.9, lw=3, col="red")
points(x=plot6bar, y=total_emissions_over_years*0.9, lw=3, col="red")
dev.off()
png(file="./plot6.png",width=480, height=480)
plot6bar <- barplot(total_emissions_LA,
main="Emissions with motor vehicle sources",
xlab="Years", las=1)
lines(x=plot6bar, y=total_emissions_LA*0.9, lw=3, col="red")
points(x=plot6bar, y=total_emissions_LA*0.9, lw=3, col="red")
dev.off()
png(file="./plot5.png",width=480, height=480)
plot5bar <- barplot(total_emissions_over_years,
main="Emissions with motor vehicle sources (Maryland)",
xlab="Years", las=1)
lines(x=plot5bar, y=total_emissions_over_years*0.9, lw=3, col="red")
points(x=plot5bar, y=total_emissions_over_years*0.9, lw=3, col="red")
dev.off()
png(file="./plot6.png",width=480, height=480)
plot6bar <- barplot(total_emissions_LA,
main="Emissions with motor vehicle sources (LA)",
xlab="Years", las=1)
lines(x=plot6bar, y=total_emissions_LA*0.9, lw=3, col="red")
points(x=plot6bar, y=total_emissions_LA*0.9, lw=3, col="red")
dev.off()
q()
