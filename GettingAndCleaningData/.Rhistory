library(xlsx)
dat_tr <- read.xlsx("/Users/youweizheng/Google Drive/HusbandStock/trades.xlsx",
sheetName = "Sheet1",colIndex=c(1,2,3,4))
i <- sapply(dat_tr, is.factor)
dat_tr[i] <- lapply(dat_tr[i], as.character)
library(lubridate)
newtrade <- c(as(today()+days(1),"character"),"广汇能源 (600256)","4516.81","碰到了无穷成本线")
dat_tr_new <- rbind(dat_tr,newtrade)
write.xlsx2(dat_tr_new,
"/Users/youweizheng/Google Drive/HusbandStock/trades.xlsx",
row.names=FALSE)
q()
library(xlsx)
dat_tr <- read.xlsx("/Users/youweizheng/Google Drive/HusbandStock/trades.xlsx",
sheetName = "Sheet1",colIndex=c(1,2,3,4))
i <- sapply(dat_tr, is.factor)
dat_tr[i] <- lapply(dat_tr[i], as.character)
library(lubridate)
newtrade <- c(as(today()+days(1),"character"),"股息红利税补缴","38.50","山西证券")
dat_tr_new <- rbind(dat_tr,newtrade)
library(lubridate)
newtrade <- c(as(today(),"character"),"股息红利税补缴","38.50","山西证券")
dat_tr_new <- rbind(dat_tr,newtrade)
write.xlsx2(dat_tr_new,
"/Users/youweizheng/Google Drive/HusbandStock/trades.xlsx",
row.names=FALSE)
q()
q()
varNames <- c("address","direction","street","crossStreet","intersection","Location.1")
tolower(varNames)
?strsplit
strsplit(varNames,split="\\.")
reviews <- c("id","solution_id","reviewer_id","start","stop","time_left","accept")
?sub
sub(pattern="_",replacement=".",reviews)
testName <- "this_is_a_test"
sub(pattern="_",replacement=".",testName)
gsub(pattern="_",replacement=".",testName)
intersections <- c("Alma","Suck","Shit","Alma","Alma","Rock")
grep(pattern="Alma",intersections)
grepl(pattern="Alma",intersections)
table(grepl(pattern="Alma",intersections))
install.packages("stringr")
?nchar
nchar("Youwei Zheng")
substr(myname,1,7)
myname <- "Youwei Zheng"
substr(myname,1,7)
nchar(myname)
substr(myname,8,12)
grep(pattern=" ",myname)
grepl(pattern=" ",myname)
?sub
gregexpr(pattern=" ",myname)
slist <- gregexpr(pattern=" ",myname)
slist[[1]]
slist[[1]][1]
pos <- gregexpr(pattern=" ",myname)[[1]][1]
pos
library(stringr)
myname <- "Youwei Zheng"
nchar(myname)
pos <- gregexpr(pattern=" ",myname)[[1]][1]
substr(myname,1,pos-1)
substr(myname,pos+1,12)
?paste0
paste("Youwei","Zheng",sep=" ")
paste("Youwei","Zheng",myname,sep=" ")
rightnow <- date()
rightnow
class(rightnow)
rm(list=ls())
d1 <- date()
d2 <- Sys.Date()
d2
class(d2)
format(d2,"%a %b %d %m %Y")
rm(list=ls())
cat("\014")
library(xlsx)
dat_tr <- read.xlsx("/Users/youweizheng/Google Drive/HusbandStock/trades.xlsx",
sheetName = "Sheet1",colIndex=c(1,2,3,4))
i <- sapply(dat_tr, is.factor)
dat_tr[i] <- lapply(dat_tr[i], as.character)
View(dat_tr)
dat_tr[18,"Stock"]
gsub(" ","",dat_tr[18,"Stock"])
dat_tr[18,"Stock"] <- gsub(" ","",dat_tr[18,"Stock"])
View(dat_tr)
dat_tr$Date
ndate3 <- as.Date("2014-07-29", "%Y-%m-%d"); ndate3
q()
buy <- 40882.68+41032.80+41182.92
sell <- 8273.38 + 33133.47 + 82933.60
sell - buy
library(xlsx)
dat_tr <- read.xlsx("/Users/youweizheng/Google Drive/HusbandStock/trades.xlsx",
sheetName = "Sheet1",colIndex=c(1,2,3,4))
i <- sapply(dat_tr, is.factor)
dat_tr[i] <- lapply(dat_tr[i], as.character)
library(lubridate)
newtrade <- c(as(today(),"character"),"信诚300B (150052)","1242","老妈抛的")
dat_tr_new <- rbind(dat_tr,newtrade)
write.xlsx2(dat_tr_new,
"/Users/youweizheng/Google Drive/HusbandStock/trades.xlsx",
row.names=FALSE)
q()
library(xlsx)
dat_tr <- read.xlsx("/Users/youweizheng/Google Drive/HusbandStock/trades.xlsx",
sheetName = "Sheet1",colIndex=c(1,2,3,4))
i <- sapply(dat_tr, is.factor)
dat_tr[i] <- lapply(dat_tr[i], as.character)
dat_tr$Profit <- as.numeric(dat_tr$Profit)
total_tr_profit <- sum(as.numeric(dat_tr$Profit),na.rm=TRUE)
library(lubridate)
library(plyr)
dat_tr$byMonth <- floor_date(dat_tr$Date, "month")
monthly_tr <- ddply(dat_tr, "byMonth", summarise, monthly = sum(Profit))
source('~/Google Drive/HusbandStock/analysis.R', echo=TRUE)
q()
rm(list=ls())
cat("\014")
dataQ1 <- read.table("./Quiz4/Q1.csv",sep=",",header=TRUE)
View(dataQ1)
varNames <- names(dataQ1)
strsplit(varNames)
q()
rm(list=ls())
cat("\014")
dataQ1 <- read.table("./Quiz4/Q1.csv",sep=",",header=TRUE)
varNames <- names(dataQ1)
?strsplit
strsplit("wgtp",varNames)
apply(varNames,strsplit("wgtp"))
?apply
apply(varNames,"wgtp",strsplit)
tes<-c("1.abc","2.di","3.lik")
dat<-c(5,3,2)
h<-data.frame(tes,dat)
h
sapply(strsplit(as.character(h$tes), "\\."), "[[", 2)
sapply(strsplit(as.character(h$tes), "\\."), "", 1)
sapply(strsplit(varNames, "wgtp"), "", 1)
sapply(strsplit(as.character(h$tes), "\\."), "[[", 1)
sapply(strsplit(varNames, "wgtp"), "[[", 1)
sapply(strsplit(varNames, "wgtp"), "[[", 2)
sapply(strsplit(varNames, "wgtp"), "[[")
sapply(strsplit(varNames, "wgtp"), "[[",1)
View(dataQ1)
dataQ2 <- read.table("./Quiz4/Q2.csv",sep=",",header=TRUE)
dataQ2 <- read.csv("./Quiz4/Q2.csv",head=TRUE)
rm(list=ls())
cat("\014")
dataQ2 <- read.csv("./Quiz4/Q2.csv",head=TRUE)
View(dataQ2)
countriesGDP <- read.csv("./Quiz2/countriesGDP.csv",head=TRUE)
countriesGDP <- read.csv("./Quiz4/countriesGDP.csv",head=TRUE)
library(data.table)
setnames(countriesGDP, "X", "ShortCode")
setnames(countriesGDP, "Gross.domestic.product.2012", "GDP.Ranking")
setnames(countriesGDP, "X.2", "Long.Name")
setnames(countriesGDP, "X.3", "Millions.Of.US.Dollar")
GDP_Rs <- countriesGDP[-c(1:4,195:330),-which(names(countriesGDP) %in% c("X.1","X.4","X.5","X.6","X.7","X.8"))]
View(GDP_Rs)
View(GDP_Rs)
class(GDP_Rs$Millions.Of.US.Dollar)
GDP_Rs$Millions.Of.US.Dollar <- as.numeric(GDP_Rs$Millions.Of.US.Dollar)
class(GDP_Rs$Millions.Of.US.Dollar)
mean(GDP_Rs$Millions.Of.US.Dollar)
View(GDP_Rs)
GDP_Rs$Millions.Of.US.Dollar <- as.character(GDP_Rs$Millions.Of.US.Dollar)
View(GDP_Rs)
# ----- Question 2:
## load data
countriesGDP <- read.csv("./Quiz4/countriesGDP.csv",head=TRUE)
## change variable names
library(data.table)
setnames(countriesGDP, "X", "ShortCode")
setnames(countriesGDP, "Gross.domestic.product.2012", "GDP.Ranking")
setnames(countriesGDP, "X.2", "Long.Name")
setnames(countriesGDP, "X.3", "Millions.Of.US.Dollar")
## drop non-valuable rows and cols
GDP_Rs <- countriesGDP[-c(1:4,195:330),-which(names(countriesGDP) %in% c("X.1","X.4","X.5","X.6","X.7","X.8"))]
GDP_Rs$Millions.Of.US.Dollar <- as.character(GDP_Rs$Millions.Of.US.Dollar)
View(GDP_Rs)
GDP_Rs$Millions.Of.US.Dollar <- as.numeric(GDP_Rs$Millions.Of.US.Dollar)
View(GDP_Rs)
# ----- Question 2:
## load data
countriesGDP <- read.csv("./Quiz4/countriesGDP.csv",head=TRUE)
## change variable names
library(data.table)
setnames(countriesGDP, "X", "ShortCode")
setnames(countriesGDP, "Gross.domestic.product.2012", "GDP.Ranking")
setnames(countriesGDP, "X.2", "Long.Name")
setnames(countriesGDP, "X.3", "Millions.Of.US.Dollar")
## drop non-valuable rows and cols
GDP_Rs <- countriesGDP[-c(1:4,195:330),-which(names(countriesGDP) %in% c("X.1","X.4","X.5","X.6","X.7","X.8"))]
## remove comma in the factor
GDP_Rs$Millions.Of.US.Dollar <- as.character(GDP_Rs$Millions.Of.US.Dollar)
gsub(pattern=",",replacement="",GDP_Rs$Millions.Of.US.Dollar)
gsub(pattern=" ",replacement="",GDP_Rs$Millions.Of.US.Dollar)
GDP_Rs$Millions.Of.US.Dollar <- gsub(pattern=",",replacement="",GDP_Rs$Millions.Of.US.Dollar)
GDP_Rs$Millions.Of.US.Dollar <- gsub(pattern=" ",replacement="",GDP_Rs$Millions.Of.US.Dollar)
View(GDP_Rs)
mean(GDP_Rs$Millions.Of.US.Dollar)
GDP_Rs$Millions.Of.US.Dollar <- as.numeric(GDP_Rs$Millions.Of.US.Dollar)
mean(GDP_Rs$Millions.Of.US.Dollar)
print(paste("Answer 2 is: ", mean(GDP_Rs$Millions.Of.US.Dollar)))
print(paste("Answer 2 is: ", mean(GDP_Rs$Millions.Of.US.Dollar,sep="")))
print(paste("Answer 2 is:", mean(GDP_Rs$Millions.Of.US.Dollar,sep="")))
?paste
print(paste("Answer 2 is:",mean(GDP_Rs$Millions.Of.US.Dollar,sep="")))
View(GDP_Rs)
grep("^United",GDP_Rs$Long.Name)
len(grep("^United",GDP_Rs$Long.Name))
length(grep("^United",GDP_Rs$Long.Name))
print(paste("Answer 3 is:",length(grep("^United",GDP_Rs$Long.Name))))
countriesEDU <- read.csv("./Quiz4/countriesEDU.csv",head=TRUE)
countriesEDU <- read.csv("./Quiz4/countriesEDU.csv",head=TRUE)
View(countriesEDU)
names(countriesEDU)
countriesEDU$Special.Notes
grep(pattern="June",countriesEDU$Special.Notes)
length(grep(pattern="June",countriesEDU$Special.Notes))
length(grep(pattern="Fiscal",countriesEDU$Special.Notes))
length(grep(pattern="Fiscal & June",countriesEDU$Special.Notes))
countriesEDU$Special.Notes[234]
countriesEDU$Special.Notes[234][1]
countriesEDU <- read.csv("./Quiz4/countriesEDU.csv",head=TRUE)
countriesEDU$Special.Notes <- as.character(countriesEDU$Special.Notes)
grep(pattern="Fiscal",countriesEDU$Special.Notes)
p1 <- grep(pattern="Fiscal",countriesEDU$Special.Notes)
countriesEDU$Special.Notes[p1]
fiscal <- countriesEDU$Special.Notes[p1]
june <- grep(pattern="June",fiscal)
print(paste("Answer 4 is:",length(june)))
rm(list=ls())
cat("\014")
library(quantmod)
amzn = getSymbols("AMZN",auto.assign=FALSE)
sampleTimes = index(amzn)
install.packages("quantmod")
rm(list=ls())
cat("\014")
library(quantmod)
amzn = getSymbols("AMZN",auto.assign=FALSE)
sampleTimes = index(amzn)
View(amzn)
names(amzn)
amzn$row.names
amzn[,1]
amzn[,0]
dates <- amzn[,0]
class(dates)
dateall <- amzn[,0]
class(dateall)
dateall[1]
View(amzn)
row.names
row.names(amzn)
class(amzn)
xts
rm(list=ls())
cat("\014")
library(quantmod)
amzn = getSymbols("AMZN",auto.assign=FALSE)
sampleTimes = index(amzn)
amazon <- data.frame(date=index(amzn), coredata(amzn))
View(amazon)
dateall <- as.character(amazon$date)
dateall
as.Date(dateall, "%Y%d%B")
for (i in 1:length(dateall)){
dates[i] <- as.Date(dateall[i], "%Y%B%d")
}
?sapply
library(lubridate)
amazon$byMonth <- floor_date(dat_tr$Date, "month")
View(amazon)
amazon$byMonth <- floor_date(amazon$date, "month")
View(amazon)
class(amazon$byMonth)
year(amazon$byMonth)
"2014" %in% year(amazon$byMonth)
year(amazon$byMonth) == 2014
sum(year(amazon$byMonth) == 2012)
month(amazon$byMonth)
day(amazon$byMonth)
wday(amazon$byMonth)
sum((year(amazon$byMonth) == 2012 & wday(amazon$byMonth) == 1) )
(year(amazon$byMonth) == 2012 & wday(amazon$byMonth) == 1)
year(amazon$byMonth) == 2012
year(amazon$byMonth) == 2012
(year(amazon$byMonth) == 2012 & wday(amazon$byMonth) == 1)
sum(year(amazon$byMonth) == 2012 & wday(amazon$byMonth) == 1)
sum(year(amazon$byMonth) == 2012 && wday(amazon$byMonth) == 1)
sum(year(amazon$byMonth) == 2012)
y2012 <- year(amazon$byMonth) == 2012)
amazon$byMonth[,y2012]
y2012 <- year(amazon$byMonth) == 2012)
y2012 <- year(amazon$byMonth == 2012)
y2012 <- as.logical(year(amazon$byMonth == 2012))
y2012 <- as.logical(year(amazon$byMonth == 2012))
y2012 <- as.logical(year(amazon$byMonth) == 2012)
amazon$byMonth[,y2012]
y2012
amazon$byMonth[y2012,]
length(amazon$byMonth)
length(y2012)
class(y2012)
y2012[1]
y2012[2]
y2012[1000]
amazon$byMonth[(y2012),]
y2012 <- which(year(amazon$byMonth) == 2012)
amazon$byMonth[y2012,]
amazon$byMonth[y2012,]
amazon$byMonth[1,]
amazon$byMonth
amazon$byMonth[1,]
amazon$byMonth
amazon$byMonth[1]
amazon$byMonth[y2012]
wday(amazon$byMonth[y2012] == 1)
wday(amazon$byMonth[y2012]) == 1
sum(wday(amazon$byMonth[y2012]) == 1)
wday(amazon$byMonth[y2012])
sum(wday(amazon$byMonth[y2012]) == 2)
d <- now()
d
wday(d)
sum(year(amazon$byMonth) == 2012 & wday(amazon$byMonth) == 2)
q()
datapath <- "/Users/youweizheng/Google Drive/老婆的学术/2014_08_ENDO_China/datasets.xlsx"
library(xlsx)
data14 <- read.xlsx(datapath,sheetIndex=1,header=TRUE)
data14
names(data14)
names(data14) <- c("Sex","Age")
View(data14)
class(data14$Age)
data14$Age == NA
data14$Age
data14$Age[1]
data14$Age[2]
data14$Age[25]
data14$Age[25] == NA
data14$Age[25] == "NA"
as.numeric(data14$Age)
as.numeric(data14$Age) == NA
as.numeric(data14$Age) < 0
as.numeric(data14$Age) > 0
?which
which(data14$Age > 0)
validIDs <- which(data14$Age > 0)
length(validIDs)
data14[validIDs,]
write.table(x, file=output, append = FALSE, sep = " ",
row.names = FALSE, col.names = TRUE)
write.table(data14[validIDs,], file=output, append = FALSE, sep = " ",
row.names = FALSE, col.names = FALSE)
output <- "/Users/youweizheng/Google Drive/老婆的学术/2014_08_ENDO_China/data14.csv"
write.table(data14[validIDs,], file=output, append = FALSE, sep = " ",
row.names = FALSE, col.names = FALSE)
q()
datapath <- "/Users/youweizheng/Google Drive/老婆的学术/2014_08_ENDO_China/datasets.xlsx"
library(xlsx)
data14 <- read.xlsx(datapath,sheetIndex=1,header=TRUE)
names(data14) <- c("Sex","Age")
validIDs <- which(data14$Age > 0)
output <- "/Users/youweizheng/Google Drive/老婆的学术/2014_08_ENDO_China/dat14both.csv"
write.table(data14[validIDs,], file=output, append = FALSE, sep = " ",
row.names = FALSE, col.names = FALSE)
datapath <- "/Users/youweizheng/Google Drive/老婆的学术/2014_08_ENDO_China/datasets.xlsx"
library(xlsx)
dat14 <- read.xlsx(datapath,sheetIndex=1,header=TRUE)
names(data14) <- c("Sex","Age")
validIDs <- which(dat14$Age > 0)
output <- "/Users/youweizheng/Google Drive/老婆的学术/2014_08_ENDO_China/dat14both.csv"
write.table(dat14[validIDs,], file=output, append = FALSE, sep = " ",
row.names = FALSE, col.names = FALSE)
datapath <- "/Users/youweizheng/Google Drive/老婆的学术/2014_08_ENDO_China/datasets.xlsx"
library(xlsx)
dat14 <- read.xlsx(datapath,sheetIndex=1,header=TRUE)
names(dat14) <- c("Sex","Age")
validIDs <- which(dat14$Age > 0)
output <- "/Users/youweizheng/Google Drive/老婆的学术/2014_08_ENDO_China/dat14both.csv"
write.table(dat14[validIDs,], file=output, append = FALSE, sep = " ",
row.names = FALSE, col.names = FALSE)
datapath <- "/Users/youweizheng/Google Drive/老婆的学术/2014_08_ENDO_China/datasets.xlsx"
library(xlsx)
dat14 <- read.xlsx(datapath,sheetIndex=1,header=TRUE)
names(dat14) <- c("Sex","Age")
validIDs <- which(dat14$Age > 0)
dat14 <- dat14[validIDs,]
output <- "/Users/youweizheng/Google Drive/老婆的学术/2014_08_ENDO_China/dat14both.csv"
write.table(dat14, file=output, append = FALSE, sep = " ",
row.names = FALSE, col.names = FALSE)
menIDs <- which(dat14$Sex == 1)
womenIDs <- which(dat14$Sex == 2)
datW <- dat14[womenIDs,]
datW <- dat14[womenIDs,2]
womenIDs <- which(dat14$Sex == 2)
datW <- dat14[womenIDs,2]
output <- "/Users/youweizheng/Google Drive/老婆的学术/2014_08_ENDO_China/dat14w.csv"
write.table(datW, file=output, append = FALSE, sep = " ",
row.names = FALSE, col.names = FALSE)
q()
source('~/Google Drive/老婆的学术/2014_08_ENDO_China/dpp.R', echo=TRUE)
datapath <- "/Users/youweizheng/Google Drive/老婆的学术/2014_08_ENDO_China/datasets.xlsx"
library(xlsx)
dat1718 <- read.xlsx(datapath,sheetIndex=2,header=TRUE)
View(dat1718)
dat17 <- dat1718[c(1:5),c(2:4)]
output <- "/Users/youweizheng/Google Drive/老婆的学术/2014_08_ENDO_China/data/dat17.csv"
write.table(dat17, file=output, append = FALSE, sep = " ",
row.names = FALSE, col.names = FALSE)
dat18 <- dat1718[c(6:9),c(2:4)]
output <- "/Users/youweizheng/Google Drive/老婆的学术/2014_08_ENDO_China/data/dat18.csv"
write.table(dat18, file=output, append = FALSE, sep = " ",
row.names = FALSE, col.names = FALSE)
names(dat1718)
datapath <- "/Users/youweizheng/Google Drive/老婆的学术/2014_08_ENDO_China/datasets.xlsx"
library(xlsx)
dat2228 <- read.xlsx(datapath,sheetIndex=3,header=TRUE)
dat2228
dat22 <- dat2228[1,c(1:3)]
output <- "/Users/youweizheng/Google Drive/老婆的学术/2014_08_ENDO_China/data/dat22.csv"
write.table(dat22, file=output, append = FALSE, sep = " ",
row.names = FALSE, col.names = FALSE)
View(dat2228)
data2228
dat2228
dat28 <- dat2228[3,c(1:4)]
output <- "/Users/youweizheng/Google Drive/老婆的学术/2014_08_ENDO_China/data/dat28.csv"
write.table(dat28, file=output, append = FALSE, sep = " ",
row.names = FALSE, col.names = FALSE)
q()
datapath <- "/Users/youweizheng/Google Drive/老婆的学术/2014_08_ENDO_China/datasets.xlsx"
library(xlsx)
dat2228 <- read.xlsx(datapath,sheetIndex=3,header=TRUE)
dat28 <- dat2228[3,c(1:4)]
dat28
swap <- c(dat28[1,3],dat28[1,2])
dat28 <- dat2228[3,c(1:4)]
swap <- c(dat28[1,3],dat28[1,2])
dat28[1,2:3] <- swap
output <- "/Users/youweizheng/Google Drive/老婆的学术/2014_08_ENDO_China/data/dat28.csv"
write.table(dat28, file=output, append = FALSE, sep = " ",
row.names = FALSE, col.names = FALSE)
View(dat28)
dat28 <- dat2228[3,c(1:4)]
swap <- c(as.numeric(dat28[1,3]),as.numeric(dat28[1,2])
dat28[1,2:3] <- swap
output <- "/Users/youweizheng/Google Drive/老婆的学术/2014_08_ENDO_China/data/dat28.csv"
write.table(dat28, file=output, append = FALSE, sep = " ",
row.names = FALSE, col.names = FALSE)
dat28 <- dat2228[3,c(1:4)]
swap <- c(dat28[1,3]dat28[1,2])
swap <- c(dat28[1,3]mdat28[1,2])
swap <- c(dat28[1,3],dat28[1,2])
View(dat28)
dat28 <- as.numeric(dat2228[3,c(1:4)])
swap <- c(dat28[1,3],dat28[1,2])
swap <- c(dat28[3],dat28[2])
dat28 <- dat2228[3,c(1:4)]
output <- "/Users/youweizheng/Google Drive/老婆的学术/2014_08_ENDO_China/data/dat28.csv"
write.table(dat28, file=output, append = FALSE, sep = " ",
row.names = FALSE, col.names = FALSE)
q()
datapath <- "/Users/youweizheng/Google Drive/老婆的学术/2014_08_ENDO_China/data/dat_original.xlsx"
library(xlsx)
dat1718 <- read.xlsx(datapath,sheetIndex=2,header=TRUE)
datapath <- "/Users/youweizheng/Google Drive/老婆的学术/2014_08_ENDO_China/data/dat_origin.xlsx"
library(xlsx)
dat1718 <- read.xlsx(datapath,sheetIndex=2,header=TRUE)
dat17 <- dat1718[c(1:5),c(2:4)]
dat17
output <- "/Users/youweizheng/Google Drive/老婆的学术/2014_08_ENDO_China/data/dat17.csv"
write.table(dat17, file=output, append = FALSE, sep = " ",
row.names = FALSE, col.names = FALSE)
q()
q()
rm(list=ls())
cat("\014")
library(xlsx)
dat_tr <- read.xlsx("/Users/youweizheng/Google Drive/HusbandStock/trades.xlsx",
sheetName = "Sheet1",colIndex=c(1,2,3,4))
i <- sapply(dat_tr, is.factor)
dat_tr[i] <- lapply(dat_tr[i], as.character)
library(lubridate)
newtrade <- c(as(today()+days(1),"character"),"长园集团 (600525)","356.87","远离均线")
dat_tr_new <- rbind(dat_tr,newtrade)
write.xlsx2(dat_tr_new,
"/Users/youweizheng/Google Drive/HusbandStock/trades.xlsx",
row.names=FALSE)
rm(list=ls())
cat("\014")
library(xlsx)
dat_tr <- read.xlsx("/Users/youweizheng/Google Drive/HusbandStock/trades.xlsx",
sheetName = "Sheet1",colIndex=c(1,2,3,4))
i <- sapply(dat_tr, is.factor)
dat_tr[i] <- lapply(dat_tr[i], as.character)
library(lubridate)
newtrade <- c(as(today()+days(1),"character"),"鱼跃医疗 (002223)","50.30","远离均线")
dat_tr_new <- rbind(dat_tr,newtrade)
write.xlsx2(dat_tr_new,
"/Users/youweizheng/Google Drive/HusbandStock/trades.xlsx",
row.names=FALSE)
q()
q()
